(()=>{"use strict";class t{constructor(t){this.length=t,this.shipSunk=!1}get lengthOfShip(){return this.length}hits(){return this.length-=1}isSunk(){return 0===this.length?this.shipSunk=!0:this.shipSunk=!1}}class e{constructor(t){this.name=t}makeRandomAttack(t){let e=!1;for(;!e;){const o=t.getRandomAttackCoordinates(),{row:n,column:s}=o;t.isCoordinateAttacked(n,s)||(e=t.receiveAttack(n,s),l(n,s))}}makeAttack(t,e,o){t.receiveAttack(e,o)}}class o{constructor(t){this.rows=10,this.columns=10,this.grid=this.createBoard(),this.attacks=[],this.ships=[],this.name=t}createBoard(){return Array.from({length:this.rows},(()=>Array(this.columns).fill(null)))}placeShip(t,e,o,n=!1){n?this.placeShipInColumn(t,e,o):this.placeShipInRow(t,e,o)}placeRandomShip(t,e=!1){let o=!1;for(;!o;){const n=Math.floor(Math.random()*this.rows),s=Math.floor(Math.random()*this.columns);try{e?this.placeShipInColumn(t,n,s):this.placeShipInRow(t,n,s),o=!0}catch(t){}}}placeShipInRow(t,e,o){if(e+t.lengthOfShip>this.rows||o+t.lengthOfShip>this.columns)throw new Error("Cannot place the ship at the given coordinates. Out of bounds.");for(let n=0;n<t.lengthOfShip;n++)if(null!==this.grid[e][o+n])throw new Error("Cannot place the ship at the given coordinates. Another ship is already there.");for(let n=0;n<t.lengthOfShip;n++)this.grid[e][o+n]=t;this.ships.push(t)}placeShipInColumn(t,e,o){if(e+t.lengthOfShip>this.rows||o+t.lengthOfShip>this.columns)throw new Error("Cannot place the ship at the given coordinates. Out of bounds.");for(let n=0;n<t.lengthOfShip;n++)if(null!==this.grid[e+n][o])throw new Error("Cannot place the ship at the given coordinates. Another ship is already there.");for(let n=0;n<t.lengthOfShip;n++)this.grid[e+n][o]=t;this.ships.push(t)}receiveAttack(t,e){if(this.attacks.some((o=>o.row===t&&o.column===e)))return console.log(`Coordinates (${t}, ${e}) have already been attacked. Please choose another pair.`),!1;{const o=this.grid[t][e];return null===o?this.grid[t][e]="o":(o.hits(),this.grid[t][e]="x"),this.attacks.push({row:t,column:e}),!0}}reportAttacks(){this.attacks.forEach((t=>console.log(`(${t.row}, ${t.column})`)))}areAllShipsSunk(){return this.ships.every((t=>t.isSunk()))}checkShipsStatus(){this.ships.forEach((t=>{0===t.lengthOfShip&&(t.shipSunk=!0)}))}getRandomAttackCoordinates(){return{row:Math.floor(Math.random()*this.rows),column:Math.floor(Math.random()*this.columns)}}isCoordinateAttacked(t,e){return this.attacks.some((o=>o.row===t&&o.column===e))}}const n=new o("player"),s=new o("computer"),r=new e("Player"),a=new e("Computer"),i=document.querySelector(".main"),c="./icons8-boom-96.png";const h=[];function l(t,e){h.forEach((o=>{const s=parseInt(o.dataset.row),r=parseInt(o.dataset.column);s===t&&r===e&&"x"===n.grid[t][e]?(o.style.backgroundImage=`url(${c})`,o.style.backgroundSize="cover"):s===t&&r===e&&"o"===n.grid[t][e]&&(o.style.backgroundColor="#bde0fe")}))}function d(t){t.addEventListener("click",(function(e){"none"===t.style.background&&(function(t,e){const o=t.currentTarget.dataset.row,a=t.currentTarget.dataset.column;null!==s.grid[o][a]?(e.style.backgroundImage="url(/src/icons8-boom-96.png)",e.style.backgroundSize="cover",r.makeAttack(s,o,a),n.checkShipsStatus(),s.checkShipsStatus()):e.style.background="#bde0fe"}(e,t),a.makeRandomAttack(n),setTimeout((()=>{!function(){const t=document.querySelector(".popup"),e=document.querySelector(".text");s.areAllShipsSunk()?(t.style.display="flex",e.textContent="You Won!"):n.areAllShipsSunk()&&(t.style.display="flex",e.textContent="You Lose!"),document.querySelector(".btn").addEventListener("click",(function(){location.reload()}))}()}),500))}))}document.addEventListener("DOMContentLoaded",(function(){!function(e){e.placeShip(new t(3),2,3),e.placeShip(new t(4),4,5),e.placeShip(new t(5),5,1),e.placeShip(new t(3),1,6,!0),e.placeShip(new t(2),0,7,!0)}(n),function(e){e.placeRandomShip(new t(3)),e.placeRandomShip(new t(4)),e.placeRandomShip(new t(5)),e.placeRandomShip(new t(3),!0),e.placeRandomShip(new t(2),!0)}(s),function(){const t=document.querySelector("main"),e=document.createElement("div");e.classList.add("gridPlayer"),t.appendChild(e);for(let t=0;t<10;t++)for(let o=0;o<10;o++){const s=document.createElement("div");s.classList.add("boxOnGridToPlayer"),s.dataset.row=t,s.dataset.column=o,s.dataset.data=n.grid[t][o],s.style["border-style"]="solid",s.style["border-width"]="0.5px",e.appendChild(s),h.push(s)}}(),function(){const t=document.createElement("div");t.classList.add("gridComputer"),i.appendChild(t);for(let e=0;e<10;e++)for(let o=0;o<10;o++){const n=document.createElement("button");n.classList.add("boxOnGridToComputer"),n.dataset.row=e,n.dataset.column=o,n.style["border-style"]="solid",n.style["border-width"]="0.5px",n.style["border-color"]="black",n.style.background="none",n.style.cursor="pointer",d(n),t.appendChild(n)}}()}))})();
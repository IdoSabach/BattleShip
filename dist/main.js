(()=>{"use strict";class t{constructor(t){this.length=t,this.shipSunk=!1}get lengthOfShip(){return this.length}hits(){return this.length-=1}isSunk(){return 0===this.length?this.shipSunk=!0:this.shipSunk=!1}}class e{constructor(t){this.name=t}makeRandomAttack(t){let e=!1;for(;!e;){const n=t.getRandomAttackCoordinates(),{row:o,column:r}=n;t.isCoordinateAttacked(o,r)||(e=t.receiveAttack(o,r),d(o,r))}}makeAttack(t,e,n){t.receiveAttack(e,n)}}class n{constructor(t){this.rows=10,this.columns=10,this.grid=this.createBoard(),this.attacks=[],this.ships=[],this.name=t}createBoard(){return Array.from({length:this.rows},(()=>Array(this.columns).fill(null)))}placeShip(t,e,n,o=!1){o?this.placeShipInColumn(t,e,n):this.placeShipInRow(t,e,n)}placeRandomShip(t,e=!1){let n=!1;for(;!n;){const o=Math.floor(Math.random()*this.rows),r=Math.floor(Math.random()*this.columns);try{e?this.placeShipInColumn(t,o,r):this.placeShipInRow(t,o,r),n=!0}catch(t){}}}placeShipInRow(t,e,n){if(e+t.lengthOfShip>this.rows||n+t.lengthOfShip>this.columns)throw new Error("Cannot place the ship at the given coordinates. Out of bounds.");for(let o=0;o<t.lengthOfShip;o++)if(null!==this.grid[e][n+o])throw new Error("Cannot place the ship at the given coordinates. Another ship is already there.");for(let o=0;o<t.lengthOfShip;o++)this.grid[e][n+o]=t;this.ships.push(t)}placeShipInColumn(t,e,n){if(e+t.lengthOfShip>this.rows||n+t.lengthOfShip>this.columns)throw new Error("Cannot place the ship at the given coordinates. Out of bounds.");for(let o=0;o<t.lengthOfShip;o++)if(null!==this.grid[e+o][n])throw new Error("Cannot place the ship at the given coordinates. Another ship is already there.");for(let o=0;o<t.lengthOfShip;o++)this.grid[e+o][n]=t;this.ships.push(t)}receiveAttack(t,e){if(this.attacks.some((n=>n.row===t&&n.column===e)))return console.log(`Coordinates (${t}, ${e}) have already been attacked. Please choose another pair.`),!1;{const n=this.grid[t][e];return null===n?this.grid[t][e]="o":(n.hits(),this.grid[t][e]="x"),this.attacks.push({row:t,column:e}),!0}}reportAttacks(){this.attacks.forEach((t=>console.log(`(${t.row}, ${t.column})`)))}areAllShipsSunk(){return this.ships.every((t=>t.isSunk()))}checkShipsStatus(){this.ships.forEach((t=>{0===t.lengthOfShip&&(t.shipSunk=!0)}))}getRandomAttackCoordinates(){return{row:Math.floor(Math.random()*this.rows),column:Math.floor(Math.random()*this.columns)}}isCoordinateAttacked(t,e){return this.attacks.some((n=>n.row===t&&n.column===e))}}const o=new n("player"),r=new n("computer"),a=new e("Player"),s=new e("Computer"),i=document.querySelector(".main"),l="icons8-boom-96.png";const c=[];function d(t,e){c.forEach((n=>{const r=parseInt(n.dataset.row),a=parseInt(n.dataset.column);r===t&&a===e&&"x"===o.grid[t][e]?(setInterval((()=>{n.style.backgroundImage=`url(${l})`}),400),n.style.backgroundSize="cover"):r===t&&a===e&&"o"===o.grid[t][e]&&setInterval((()=>{n.style.backgroundColor="#bde0fe"}),400)}))}function h(t){t.addEventListener("click",(function(e){"none"===t.style.background&&(function(t,e){const n=t.currentTarget.dataset.row,s=t.currentTarget.dataset.column;null!==r.grid[n][s]?(e.style.backgroundImage=`url(${l})`,e.style.backgroundSize="cover",a.makeAttack(r,n,s),o.checkShipsStatus(),r.checkShipsStatus()):e.style.background="#bde0fe"}(e,t),s.makeRandomAttack(o),setTimeout((()=>{!function(){const t=document.querySelector(".popup"),e=document.querySelector(".text");r.areAllShipsSunk()?(t.style.display="flex",e.textContent="You Won!"):o.areAllShipsSunk()&&(t.style.display="flex",e.textContent="You Lose!"),document.querySelector(".btn").addEventListener("click",(function(){location.reload()}))}()}),500))}))}const u=document.querySelector(".boardOfStart"),p=document.querySelector(".btnSwitch"),m=(document.querySelector(".boxForStart"),document.querySelectorAll(".ship"));function f(){!function(){for(let t=0;t<10;t++){S[t]=[];for(let e=0;e<10;e++){const n=document.createElement("div");n.classList.add("boxStart"),n.dataset.row=t,n.dataset.column=e,n.style["border-style"]="solid",n.style["border-width"]="0.5px",u.appendChild(n),S[t][e]=0}}}(),p.addEventListener("click",(function(){y=!y,console.log(y)})),function(){const t=document.querySelectorAll(".boxStart");m.forEach((t=>{t.addEventListener("dragstart",(function(e){const n=t.classList[1];g[n]?(e.preventDefault(),console.log(t.dataset.length)):e.dataTransfer.setData("text/plain",n)}))})),t.forEach((t=>{t.addEventListener("dragover",(function(t){t.preventDefault()})),t.addEventListener("drop",(function(e){const n=e.dataTransfer.getData("text/plain"),o=document.querySelector(`.${n}`),r=parseInt(t.dataset.row),a=parseInt(t.dataset.column);(function(t,e,n){const o=parseInt(t.dataset.length);if(y){if("x"===S[e][n]||"x"===S[e+1][n]||"x"===S[e+2][n]||"x"===S[e+3][n]||"x"===S[e+4][n]||"x"===S[e+5][n])return!1;if(e+o<=10)return!0}else{if("x"===S[e][n]||"x"===S[e][n+1]||"x"===S[e][n+2]||"x"===S[e][n+3]||"x"===S[e][n+4]||"x"===S[e][n+5])return!1;if(n+o<=10)return!0}return!1})(o,r,a)&&(t.appendChild(o),function(t,e,n){const o=parseInt(document.querySelector(`.${t}`).dataset.length);if(console.log(o),y)for(let t=0;t<o;t++)S[e+t][n]="x";else for(let t=0;t<o;t++)S[e][n+t]="x";!function(t,e,n){console.log(`this is places ${t},${e},${n}`)}(length,e,n),console.log("Updated Board Array:",S)}(n,r,a),g[n]=!0)}))}))}()}let S=[];const g={};console.log(S),console.log(S);let y=!1;console.log(S),document.addEventListener("DOMContentLoaded",(function(){f(),function(e){e.placeShip(new t(3),2,3),e.placeShip(new t(4),4,5),e.placeShip(new t(5),5,1),e.placeShip(new t(3),1,6,!0),e.placeShip(new t(2),0,7,!0)}(o),function(e){e.placeRandomShip(new t(3)),e.placeRandomShip(new t(4)),e.placeRandomShip(new t(5)),e.placeRandomShip(new t(3),!0),e.placeRandomShip(new t(2),!0)}(r),function(){const t=document.querySelector("main"),e=document.createElement("div");e.classList.add("AllGridPlayer");const n=document.createElement("div"),r=document.createElement("div");r.classList.add("yourName"),r.textContent="Player",e.appendChild(r),e.appendChild(n),n.classList.add("gridPlayer"),t.appendChild(e);for(let t=0;t<10;t++)for(let e=0;e<10;e++){const r=document.createElement("div");r.classList.add("boxOnGridToPlayer"),r.dataset.row=t,r.dataset.column=e,r.dataset.data=o.grid[t][e],r.style["border-style"]="solid",r.style["border-width"]="0.5px",n.appendChild(r),c.push(r)}}(),function(){const t=document.createElement("div");t.classList.add("AllGridPlayerComputer");const e=document.createElement("div"),n=document.createElement("div");n.classList.add("computerName"),n.textContent="Computer",e.classList.add("gridComputer"),t.appendChild(n),t.appendChild(e),i.appendChild(t);for(let t=0;t<10;t++)for(let n=0;n<10;n++){const o=document.createElement("button");o.classList.add("boxOnGridToComputer"),o.dataset.row=t,o.dataset.column=n,o.style["border-style"]="solid",o.style["border-width"]="0.5px",o.style["border-color"]="black",o.style.background="none",o.style.cursor="pointer",h(o),e.appendChild(o)}}()})),document.querySelector(".boxForStart").addEventListener("touchmove",(function(t){t.preventDefault()}))})();